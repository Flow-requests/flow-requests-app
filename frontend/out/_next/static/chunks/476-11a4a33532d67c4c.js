(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[476],{5953:(e,t,s)=>{"use strict";s.d(t,{UK:()=>a,Yr:()=>n,zx:()=>r});var o=s(39212);function a(){return o.A.plugins.toArray()}function n(e){return o.A.plugins.add(e)}function r(e){return o.A.plugins.delete(e)}},10838:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});class PackageUtil{async load(customPackages){let state=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};await this.install(customPackages);let customNode=[];for(let customPackage of customPackages){let instance=eval("".concat(customPackage.libraryName));instance.default?customNode.push(new instance.default(state)):customNode.push(new instance(state))}return customNode}async install(e){for(let t of e)document.getElementById(t.libraryName)||await new Promise((e,s)=>{let o=document.createElement("script");o.src=t.url,o.id=t.libraryName,o.async=!1,o.onload=async()=>{e({})},o.onerror=()=>{console.error("Error loading ".concat(t.libraryName,".")),s()},document.body.appendChild(o)})}}let __WEBPACK_DEFAULT_EXPORT__=PackageUtil},16657:e=>{function t(e){return Promise.resolve().then(()=>{var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=()=>[],t.resolve=t,t.id=16657,e.exports=t},34595:(e,t,s)=>{"use strict";s.d(t,{T:()=>o});let o=s(73897).zp},39212:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let o=new(s(10005)).cf("FlowRequests");o.version(1).stores({workflows:"++id",plugins:"++id"});let a=o},53999:(e,t,s)=>{"use strict";s.d(t,{cn:()=>n});var o=s(52596),a=s(39688);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.QP)((0,o.$)(t))}},80203:(e,t,s)=>{"use strict";s.d(t,{A:()=>R});var o=s(12115),a=s(59362),n=s(38543),r=s(97468),i=s(40762);class d extends r.ay{getConfig(){return{name:"Code",type:"code",description:"Code node",ai_description:"Focus to run custom js or javascript code logic",properties:[{label:"Code",name:"code",type:"string",required:!0,default:"function node() { console.log('Hello World') }",description:"Any code need to be inside the function node(). For example: code 'function node() { // code logic here }' "}]}}async execute(e){return{ok:!0}}constructor(e){super(e)}}let l=d;class u extends r.ay{getConfig(){return{name:"Condition",type:"condition",description:"Condition node",ai_description:"Use this node when you can compare values or check something",properties:[{label:"Condition on left side",name:"left",type:"text",required:!1,default:""},{label:"Condition on right side",name:"right",type:"text",required:!1,default:""},{label:"Condition to compare the left and right data",name:"operator",ai_description:'\n            Valid operators: \n              "==" => means compare if left and right is equal\n              "===" => means compare if left and rigth is equal and has same data type\n              "!=" => means compare if left and rigth is not equal or if left and right are different\n              ">" => means compare if left is greater than rigth\n              "<" => means compare if left is less than rigth\n              ">=" => means compare if left is greater than or equal to rigth\n              "<=" => means compare if left is less than or equal to rigth\n          ',default:"==",required:!1,type:"text"}]}}execute(e){var t;let s=e.settings,o=this.parseExpression(s.condition.left.value),a=this.parseExpression(s.condition.right.value);isNaN(parseFloat(o))||(o=parseFloat(o)),isNaN(parseFloat(a))||(a=parseFloat(a));let n={"==":(e,t)=>e==t,"===":(e,t)=>e===t,"!=":(e,t)=>e!=t,">":(e,t)=>e>t,"<":(e,t)=>e<t,">=":(e,t)=>e>=t,"<=":(e,t)=>e<=t},r=null==s||null==(t=s.condition)?void 0:t.operator;if(!n[r])throw Error("Invalid operator");return(console.log(n[r](o,a)),n[r](o,a))?s.success:s.fail}constructor(e){super(e)}}var c=s(23464);class p extends r.ay{getConfig(){return{name:"Http Request",type:"api",description:"Http Request node",ai_description:"Node to make HTTP requests to external APIs, services or websites.",properties:[{label:"Method",name:"method",type:"string",required:!1,default:"GET",ai_description:"The HTTP method to use for the request (e.g., GET, POST, PUT, DELETE)."},{label:"Endpoint",name:"endpoint",type:"string",required:!1,default:""},{label:"Body",name:"body",type:"array",required:!1,default:[{key:"value"}]},{label:"Headers",name:"headers",type:"array",required:!1,default:[{key:"value"}]}]}}async execute(e){let t=e.settings,s={};for(let e=0;e<t.body.length;e+=1){let o=t.body[e];if(!o.value)continue;let a=this.parseExpression(o.value);try{s[o.key]=JSON.parse(a)}catch(e){s[o.key]=a}}let o={};for(let e=0;e<t.headers.length;e+=1){let s=t.headers[e];if(!s.value)continue;let a=this.parseExpression(s.value);try{o[s.key]=JSON.parse(a)}catch(e){o[s.key]=a}}if("GET"==t.method.toUpperCase())return(await c.A.get(this.parseExpression(t.url),{headers:o})).data;if("DELETE"==t.method.toUpperCase())return(await c.A.delete(this.parseExpression(t.url),{headers:o})).data;if("POST"==t.method.toUpperCase()){let e=await c.A.post(this.parseExpression(t.url),s,{headers:o});return(null==e?void 0:e.data)||{}}if("PUT"==t.method.toUpperCase()){let e=await c.A.put(this.parseExpression(t.url),s,{headers:o});return(null==e?void 0:e.data)||{}}}constructor(e){super(e)}}class f extends r.ay{getConfig(){return{name:"Loop",type:"loop",description:"Loop node",ai_description:"Node focus on execute repetitive actions",properties:[{label:"Loop",type:"text",name:"source",default:"[1,2,3]",required:!0}]}}async execute(e){let t=e.settings,s=this.parseExpression(t.source);try{s=JSON.parse(s)}catch(e){}console.log(s),console.log(s.length);let o={[e.name]:{currentItem:null}},a={nodes:t.nodes,steps:o,envData:[]};for(let t=0;t<s.length;t+=1){let n=s[t];o[e.name].currentItem=n,this.state.steps={...this.state.steps,...o},await this.engine.process(a),this.state.steps={...this.state.steps,...o,...this.engine.getState().steps}}return this.state.steps={...this.state.steps,...o},{}}constructor(e,t){super(e),this.engine=t}}class h extends r.ay{getConfig(){return{name:"Start",type:"start",description:"Start node",properties:[]}}execute(e){return Promise.resolve({})}constructor(e){super(e)}}class g{getState(){return this.state}getWorkflowAsLinkedList(e){let t=new r.wl;if(e.nodes instanceof r.wl)return e.nodes;for(let s=0;s<e.nodes.length;s+=1){let o=e.nodes[s];if((null==o?void 0:o.type)=="condition"){let e=new r.wl;o.setting.success.forEach(t=>e.add(t)),o.setting.success=e;let s=new r.wl;o.setting.fail.forEach(e=>s.add(e)),o.setting.fail=s,t.add(o)}else if((null==o?void 0:o.type)=="loop"){let e=new r.wl;o.setting.nodes.forEach(t=>e.add(t)),o.setting.nodes=e,t.add(o)}else t.add(o)}return t}async process(e,t){this.state={...e},this.state.nodes=this.getWorkflowAsLinkedList(e),this.state.envData={},e.envData.length>0&&e.envData.forEach(e=>{this.state.envData[e.key]=e.value}),this.state.request=t,this.state.steps={...this.state.steps},this.state.faker=i.a;let s={start:e=>new h(e),api:e=>new p(e),condition:e=>new u(e),code:e=>new l(e),loop:e=>new f(e,new g(this.customNodeManager))},o=this.state.nodes.head;for(;null!=o;){let e,t,a=null==o?void 0:o.value,n=a.name;e=s[a.type]?s[a.type](this.state):await this.customNodeManager.getCustomNodeByType(a.type,this.state);try{t=await e.execute({...a,settings:a.setting||{},steps:this.state.steps})}catch(e){e.response?t={error:{status:e.response.status,data:e.response.data}}:(console.log(e),t={error:{message:e.message}})}if(t instanceof r.wl){o=t.head,this.state.steps[n]={output:{},input:this.state.request||{}};continue}this.state.steps[n]={output:t,input:this.state.request||{}},o=o.next}}constructor(e){this.state,this.customNodeManager=e}}let m=g;class y{async init(e){this.isLoadCustomNodes||(this.customNodes=await this.packageUtil.load(this.packagesCustomNodes,e),this.isLoadCustomNodes=!0)}async getCustomNodeByType(e,t){await this.init(t);let s=this.customNodes.find(t=>t.getConfig().type.toLowerCase()==e.toLowerCase());if(!s)throw Error("Custom node not found");return s}async getCustomNodes(e){return await this.init(e),this.customNodes}constructor(e=[],t){this.packagesCustomNodes=e,this.packageUtil=t,this.customNodes=[],this.isLoadCustomNodes=!1}}let w=y;var v=s(10838),N=s(50125),b=s(61612),x=s(63946);class k{setUp(){let e=localStorage.getItem("openRouterToken");if(!e)return void alert("You need to setup the OpenRouter token");this.model=new x.Db({model:"openai/gpt-4.1-mini",configuration:{apiKey:e,baseURL:"https://openrouter.ai/api/v1",dangerouslyAllowBrowser:!0}})}getCreateTool(){return(0,N.z6)(async e=>{let{userPrompt:t}=e,s="You are the assistent to build workflows based the nodes information provide below.\n";for(let e of(s+="The nodes available are:\n",[new l({}),new u({}),new p({}),new f({},null),new h({})]))s+="".concat(JSON.stringify({...e.getConfig(),isCustomNode:!1}),"\n\n");for(let e of this.customNodes)s+="".concat(JSON.stringify({...e.getConfig(),isCustomNode:!0}),"\n\n");s+="\n\n MUST ONLY:\n",s+="- User only the nodes provided to answer the questions\n",s+="- Need to return the nodes in json format and follow the format of json from Node\n",s+="- RETURN ONLY the node data in JSON format.",s+="- If found a valid node return a json ONLY, if not found return the word 'NOT_FOUND' ONLY",s+="- NO RETURN a json struct like that { node: { key_data_here: value_data_here} } ONLY RETURN a node like: { key_data_here: value_data_here }",s+="- Set to the key 'type' must to have value equal one of nodes listed";let o=(0,N.Sn)({model:this.model,tools:[],systemPrompt:s}),a=await o.invoke({messages:{type:"user",content:t}}),n=a.messages[a.messages.length-1];return(null==n?void 0:n.content)||""},{name:"create_node",description:"Call this tool when need to create or add a node",schema:b.Ay.object({userPrompt:b.Ay.string().describe("The message user sent")})})}getEditNodeTool(){return(0,N.z6)(async e=>{let{userPrompt:t,currentNodes:s}=e,o="You are the assistent to build and edit workflows based the nodes information provide below.\n";for(let e of(o+="The nodes available are:\n",o+="Current nodes from worflow: ".concat(s),[new l({}),new u({}),new p({}),new f({},null),new h({})]))o+="".concat(JSON.stringify({...e.getConfig(),isCustomNode:!1}),"\n\n");for(let e of this.customNodes)o+="".concat(JSON.stringify({...e.getConfig(),isCustomNode:!0}),"\n\n");o+="\n\n MUST ONLY:\n",o+="- User only the nodes provided to answer the questions\n",o+="- Need to return the nodes in json format and follow the format of json from Node\n",o+="- RETURN ONLY the node data in JSON format.",o+="- If found a valid node return a json ONLY, if not found return the word 'NOT_FOUND' ONLY",o+="- NO RETURN a json struct like that { node: { key_data_here: value_data_here} } ONLY RETURN a node like: { key_data_here: value_data_here }";let a=(0,N.Sn)({model:this.model,tools:[],systemPrompt:o}),n=await a.invoke({messages:{type:"user",content:t}}),r=n.messages[n.messages.length-1];return(null==r?void 0:r.content)||""},{name:"edit_node",description:"Call this tool when need to edit or modify a node",schema:b.Ay.object({userPrompt:b.Ay.string().describe("The message user sent"),currentNodes:b.Ay.string().describe("The current nodes from workflow to edit")})})}extractJSONFromResponse(e){let t=/```[\s\S]*?```/g.exec(String(e));return t?t[0].replace("```json","").replace("```",""):e}async processUserMessage(e,t){var s;let o="You are the assistent to help to build workflows and use the tools to answer the user instructions.\n";for(let t of(o+="\n\n MUST ONLY:\n",o+="- User only the nodes provided to answer the questions\n",o+="- Need to return the nodes in json format and follow the format of json from Node\n",o+="- RETURN ONLY the node data in JSON format.",o+="- If found a valid node return a json ONLY, if not found return the word 'NOT_FOUND' ONLY",o+="- NO RETURN a json struct like that { node: { key_data_here: value_data_here} } ONLY RETURN a node like: { key_data_here: value_data_here }",o+="EXTRA INFO:\n",o+="When I said 'use the output from component trigger api 2' means set value in this format here: {{this.state.steps.trigger_api_2.output}}",o+="When I said 'use the credential TOKEN or another KEY or sensitive data TOKEN or another key' means set value in this format here: {{this.state.sensitiveData.TOKENorKey}}",o+="- Set to the key 'type' must to have value 'api'",o+="Current nodes from worflow:",e))o+="".concat(JSON.stringify(t),"\n\n");let a=(0,N.Sn)({model:this.model,tools:[this.getCreateTool(),this.getEditNodeTool()],systemPrompt:o}),n=null==(s=(await a.invoke({messages:{type:"user",content:t}})).messages.at(-1))?void 0:s.content,r=String(n);if("NOT_FOUND"==r)throw Error("Node not found");n&&(r=this.extractJSONFromResponse(String(n)));try{return JSON.parse(r)}catch(e){return r}}constructor(e){this.customNodes=e,this.setUp()}}let O=k;var E=s(39212);async function C(){return(await E.A.workflows.toArray()).map(e=>{let t=JSON.parse(e.data);return{id:e.id,name:t.name,data:JSON.parse(e.data)}})}async function _(e){return(await E.A.workflows.toArray()).find(t=>t.id==e)||null}function T(e,t){return E.A.workflows.update(e,t)}function S(e){return E.A.workflows.add(e)}function U(e){return E.A.workflows.delete(e)}var j=s(5953);let L=new v.A,R=function(){let[e,t]=(0,o.useState)([]),[s,r]=(0,o.useState)(null),[i,d]=(0,o.useState)([]),[l,u]=(0,o.useState)(!1),[c,p]=(0,o.useState)(!1),f=async()=>{try{let e=await C();t(e)}catch(e){n.oR.error(e.message||"Failed to fetch workflows")}},h=async e=>{await U(e),f()};function g(e){let t=[];return Object.keys(e).forEach(s=>{t.push({step:s,output:e[s].output,input:e[s].input})}),t}let y=async()=>{let e=await j.UK();return L.load(e,{})},v=()=>{let e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=async e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];if(!s)return;let o=await s.text();try{let e=JSON.parse(o);if(!e.plugins||!Array.isArray(e.plugins)||!e.flows||!Array.isArray(e.flows))throw Error("Invalid format: expected { plugins: [...], flows: [...] }");for(let t of e.plugins){if("boolean"!=typeof t.enabled||"string"!=typeof t.libraryName||"string"!=typeof t.url)throw Error("Invalid plugin format");await j.Yr({enabled:t.enabled,libraryName:t.libraryName,url:t.url})}for(let t of e.flows){if("string"!=typeof t.id||"string"!=typeof t.data)throw Error("Invalid flow format");await S({data:t.data})}f(),n.oR.success("Flows and plugins imported successfully")}catch(e){n.oR.error(e.message||"Failed to import")}},e.click()};return{workflows:e,getWorkflows:f,deleteWorkflow:h,getWorkflowById:async e=>{r(JSON.parse((await _(e)).data))},workflow:s,runWorkflow:async e=>{p(!0),u(!0);try{let t=await j.UK(),s=new w(t,L),o=new m(s);await o.process({nodes:e.nodes||[],envData:e.envData},{});let a=o.getState();d(g(a.steps)),n.oR.success("Workflow executed successfully")}catch(e){e.response instanceof a.pe&&n.oR.error(e.response.data.error),d([])}finally{p(!1)}},logs:i,isLogsModalOpen:l,setIsLogsModalOpen:u,isRunningWorkflow:c,updateWorkflow:async e=>{await T(e.workflowId,{data:JSON.stringify(e)}),n.oR.success("Workflow atualizado com sucesso")},getCustomNodes:async()=>{let e=await j.UK();return(await L.load(e,{})).map(e=>e.getConfig())},createWorkflow:async e=>{let t=await S({data:JSON.stringify(e)});return n.oR.success("Workflow created successfully"),{id:t}},handleUserChatMessage:async(e,t)=>{try{let s=await y(),o=new O(s);return{data:{result:await o.processUserMessage(t,e)}}}catch(e){return console.log(e),{data:{result:e.message||e.response.data.error.messa}}}},exportFlows:async()=>{let e=await C(),t=new Blob([JSON.stringify({plugins:(await j.UK()).map(e=>({enabled:e.enabled,libraryName:e.libraryName,url:e.url})),flows:e.map(e=>({id:e.id.toString(),data:e.data}))},null,2)],{type:"application/json"}),s=URL.createObjectURL(t),o=document.createElement("a");o.href=s,o.download="flows.json",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)},importFlows:v}}},97168:(e,t,s)=>{"use strict";s.d(t,{$:()=>d});var o=s(95155);s(12115);var a=s(99708),n=s(74466),r=s(53999);let i=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function d(e){let{className:t,variant:s,size:n,asChild:d=!1,...l}=e,u=d?a.DX:"button";return(0,o.jsx)(u,{"data-slot":"button",className:(0,r.cn)(i({variant:s,size:n,className:t})),...l})}},99474:(e,t,s)=>{"use strict";s.d(t,{T:()=>n});var o=s(95155);s(12115);var a=s(53999);function n(e){let{className:t,...s}=e;return(0,o.jsx)("textarea",{"data-slot":"textarea",className:(0,a.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...s})}},99840:(e,t,s)=>{"use strict";s.d(t,{Cf:()=>u,Es:()=>p,L3:()=>f,c7:()=>c,lG:()=>i,rr:()=>h});var o=s(95155);s(12115);var a=s(95650),n=s(54416),r=s(53999);function i(e){let{...t}=e;return(0,o.jsx)(a.bL,{"data-slot":"dialog",...t})}function d(e){let{...t}=e;return(0,o.jsx)(a.ZL,{"data-slot":"dialog-portal",...t})}function l(e){let{className:t,...s}=e;return(0,o.jsx)(a.hJ,{"data-slot":"dialog-overlay",className:(0,r.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function u(e){let{className:t,children:s,...i}=e;return(0,o.jsxs)(d,{"data-slot":"dialog-portal",children:[(0,o.jsx)(l,{}),(0,o.jsxs)(a.UC,{"data-slot":"dialog-content",className:(0,r.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...i,children:[s,(0,o.jsxs)(a.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,o.jsx)(n.A,{}),(0,o.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function c(e){let{className:t,...s}=e;return(0,o.jsx)("div",{"data-slot":"dialog-header",className:(0,r.cn)("flex flex-col gap-2 text-center sm:text-left",t),...s})}function p(e){let{className:t,...s}=e;return(0,o.jsx)("div",{"data-slot":"dialog-footer",className:(0,r.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...s})}function f(e){let{className:t,...s}=e;return(0,o.jsx)(a.hE,{"data-slot":"dialog-title",className:(0,r.cn)("text-lg leading-none font-semibold",t),...s})}function h(e){let{className:t,...s}=e;return(0,o.jsx)(a.VY,{"data-slot":"dialog-description",className:(0,r.cn)("text-muted-foreground text-sm",t),...s})}}}]);